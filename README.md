# kubera-skeleton
## 現在鋭意作成中です！
ツール本体も、このスケルトンも、日々空き時間を見つけて作成しているところです。  
誤動作するところもあれば、ちょっと変な動きをするところなど多々あると思います。  
生暖かく見守っていただきつつ、気になる所や、こういう機能が合ったら便利だなと思う点などありましたら、Issueにてご報告いただけると幸いです。

## このリポジトリ（プロジェクト）は？
[kubera](https://github.com/kubera-test/kubera) というテストツールを利用してテスト自動化を行うテストプロジェクトのスケルトンです。

## Kubera とは？
「クベーラ」と読みます。E2Eテストの自動化を簡単に作成、実施できるようにするための自動化サポートツールです。  
決められたルールに従って作成されたテストケース(Excelファイル)を読み込んで、そのままテストを実行することができます。  

画面の操作は、`Selenium`,`Selenide`を利用しています。
JUnit ベースで実行されるので、CIツールと相性が良いです。

## 必要な環境
- Java 11 以上
- Maven 3.6.0 以上

## 使い方
### スケルトンのダウンロード
[Download ZIP](https://github.com/kubera-test/kubera-skeleton/archive/refs/heads/main.zip) からダウンロードしてください。  
(`clone`しても、`fork`しても、何でも大丈夫です)

### ローカルリポジトリへの登録
当ライブラリはまだ Maven Central に登録されていないので、ローカルリポジトリに登録して利用します。  
Maven の clean で登録されるようになっていますので、コマンドを実行しておいてください。
```shell
$ mvn clean
```

#### jar の最新化
新しいバージョンの jar が配信された場合は、`lib`ディレクトリに`jar`を配置して、`pom.xml`の`kubera.test.version`を更新してから、ローカルリポジトリへの再登録を行ってください。
```xml
<properties>
    <kubera.test.version>0.6</kubera.test.version>
</properties>
```

### 画面操作候補一覧の作成
当ツールではテスト対象の画面ごとに、操作出来る要素の抽出と操作の一覧を作成することが出来ます。  

#### ツールの起動
`kubera-skeleton`のルートディレクトリにて、以下のコマンドを実行してください。  
**現在のバージョンでは Chrome が必要となります。**
```shell
$ mvn compile exec:java -Dexec.args=[http://localhost:8080(テスト対象のトップページURL)]
```
ブラウザが起動して、ツールを実行したターミナルには以下のようなログが出力されます。
```shell
画面操作シートを作成します。
作成したい画面まで操作したらシート名を入力してEnterを押してください。
シート名を入力しない場合は連続する番号をシート名として作成しますので、何も入力せずにEnterを押してください。
終了する場合は、"exit"と入力してEnterを押してください。
シート名を入力してEnterを押してください[1]:
```

#### ツールの操作方法
ターミナルに表示された文章に従って操作を行ってください。  
作成されるシート名を気にしない場合は、画面を移動させてEnterキーを押す。という行為を繰り返すだけで大丈夫です。

##### 複数の画面が表示されている場合
複数の画面が表示されている場合は、ツールを実行したターミナルに以下のようなログが表示されます。
```shell
ウィンドウまたはタブが複数開かれています。取り込み対象のページ番号を入力してください。
[1]:メイン画面
 2 :サブ画面
```
画面のタイトルがリストで表示されますので、対象の画面の番号を入力してEnterキーを押してください。
[]で囲まれた数字は、デフォルトの番号です。Enterキーを押すだけで、その番号の画面を操作対象として取り込みます。

#### ファイルの保存
`exit`を入力して終了すると（WARNINGがたくさん表示されますが・・・）実行したディレクトリに`test.xlsx`というファイルが作成されます。  
**現在のバージョンでは常にこの場所にこのファイル名で出力されます。開いていると保存に失敗しますので注意してください**  
ファイル名を変更して保管して利用してください。

### テストケースの作成
テストケースは上から下に向かって操作/検証の方法を順番に記載していき、同様の操作で値を変えて検証したいパターンを列として記載していきます。  
記載方法の詳細は Wiki(作成中) を参照してください。

#### 基本的な作り方
1. [/src/main/resources/ExcelTestCase/](https://github.com/kubera-test/kubera-skeleton/tree/main/src/main/resources/ExcelTestCase/) にある`kubera-template.xlsx`の`default`シートをコピーしてテストケースを作成していきます。  
1. 作成しておいた`画面操作候補一覧`から、操作したい内容が書かれた行をコピーして、テストケースのシートに追加していきます。（縦方向）
1. 各操作に対して、実際のテストパターンを記載していきます。（横方向）
   1. テストケース名：テストケースを識別するためのケース名を記載します。重複しても構いません。未記載の列はスキップします
   1. 除外対象：テストを実行する際に（一時的になど）実行をスキップしたい場合に何か文字を入力してください
   1. 各操作：各操作の種類に応じて必要な内容を記載します。未記載にした場合はその行の操作を行いません
      1. 値の入力、検証系：入力する値、検証する値を記載します
      1. スクリーンショット：出力するファイル名を記載します
      1. その他：何かしら文字を入力すると実行されます

#### Excel記載フォーマットのカスタマイズ
ツールがテストケースとして扱うエリアは指定することができますので、必要に応じてカスタマイズしてください。  
（詳細はまとめ中です）

## 利用しているツール類(Special Thanks)
- Selenium(https://www.selenium.dev/)
- Selenide(https://selenide.org/)
- Apache POI(https://poi.apache.org/)
- テスト自動化の学習用の練習サイト(https://hotel.testplanisphere.dev/ja/, https://github.com/testplanisphere/hotel-example-site)

## ライセンス
KuberaはMITライセンスで公開されています。